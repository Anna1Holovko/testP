<apex:page controller="AccountRelSalesOrdersController" showHeader="false" sidebar="false">
    <apex:stylesheet value="{!URLFOR($Resource.renegade_stylesheet)}"/>   
    <!--script type="text/javascript">
    var uri = window.location.toString();
    if (uri.indexOf("?") > 0) {
        var clean_uri = uri.substring(0, uri.indexOf("?"));
        window.history.replaceState({}, document.title, clean_uri);
    }
    </script-->

    <apex:form > 
        <html>
            <head>
                <title>Renegade Account Related SalesOrders Page</title>
                <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
                <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
                <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/plug-ins/a5734b29083/integration/bootstrap/3/dataTables.bootstrap.css"/>
            </head>
            
            <style>
                body .bPageBlock .pbBody .labelCol, body .print .topics-label {width:0% !important;}
                body .bPageBlock .pbBody .dataCol { width: 0% !important;}
                body .btn{background: #69c5ec !important;outline:0 !important; }
                
                .header_container {
                max-width: 1170px;
                margin: 0 auto;
                position: relative;
                padding:15px 8px;
                }
                .main-container {
                max-width: 1170px;
                margin: 0 auto;
                position: relative;
                }
                .heading-orange-color{
                color: #fa692f;
                font-family: inherit;
                font-size: 30px;
                font-weight: normal;
                padding: 10px 10px;
                }
                .popup_section_header{margin-bottom:7px; }
                .popup_headings{color: #1195CE;font-weight:bold;font-size:14px;}
                .popup_outputpanel{overflow:auto;height:444px;margin-bottom: 20px;border-top: 2px solid #DDD;
                                   border-bottom: 2px solid #DDD;}
                .manualorder-popupBackground{
                overflow: auto;
                background-color:black;
                opacity: 0.7;
                filter: alpha(opacity = 20);
                position:fixed;
                width: 100%;
                height:191%;
                top: 0%;
                left: 0%;
                z-index: 1001;
                }
                .manualorder-custPopup{
                background-color: white;
                z-index: 9999;
                position: fixed;
                margin-left: -500px;
                border-radius: 8px;
                width: 888px;
                margin-left: --455px;
                top: 6%;
                left: 48%;
                }
                .manualorder-popupcontent_container{
                width: 95%;
                margin: 3% auto 1%;
                }
                .manualorder-table2-content{text-align:center;}
                .man-step2-save-btn{
                margin: 1% auto 0%;
                width: 10%;
                }
                .effect6
                {
                position:relative;
                -webkit-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
                -moz-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
                -ms-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
                -o-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
                box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
                }
                .manstep3-popupbtn{
                width: 14% !important;
                float:left;
                padding: 5px 0px !important;
                font-size: 19px !important;
                outline: 0 !important;
                font-weight: 300 !important;
                color: #ffffff !important;
                font-family: 'Lato',sans-serif !important;
                background-color: #69c5ec !important;
                border: 1px solid #B3B3B3 !important;
                }
                .manstep3-savebtn {
                font-family: 'Lato',sans-serif !important;
                background-color: #69c5ec !important;
                border: 1px solid #B3B3B3 !important;
                float: left !important;
                font-size: 20px !important;
                font-weight: 300 !important;
                color: #ffffff !important;
                padding: 10px 23px !important;
                outline:0 !important;
                }
                .manstep3-savebtn:hover {
                background-color:#2DA7DA !important;
                outline:0 !important;
                }
                .manstep3-savebtn:active {
                position:relative;
                top:1px;
                }
                .popup_outputpanel h4{
                font-size: 14px;
                font-weight: bold;
                color: #1195CE;
                }
                .row {
                 margin-right: 0px !important; 
                 margin-left: 0px !important;
                }
                hr {
                margin-top:5px !important;
                margin-bottom:5px !important;
                }
                .infoM3{margin-bottom:15px !important}
            </style>
            <script>
            function close()
            {
                location.reload();
            }
            </script>
            <body>
              
                <!-- Popup Container -->
                 <apex:outputPanel id="tstpopup">
                     <apex:outputPanel styleClass="manualorder-popupBackground" layout="block" rendered="{!displayPopUp}"/>
                     <apex:outputPanel styleClass="manualorder-custPopup" layout="block" rendered="{!displayPopUp}" style="width: 960px;height: auto;margin-left: -457px;">
                         <div>
                             <apex:commandButton value="âœ–" rerender="tstpopup" styleClass="manstep3-savebtn manstep3-popupbtn" style="width: 35px !important;font-size: 16px !important;padding: 5px 10px !important;border-radius: 50px;float: right !important; position: relative;margin-top: -10px;margin-right: -10px;" oncomplete="close()" >
                                 <apex:param assignTo="{!displayPopup}" value="false" name="displayPopup" />
                             </apex:commandButton>
                         </div>
                         <!-- popup inner container-->
                         <div class="manualorder-popupcontent_container" style="padding:10px;"> 
                            
                          <!-- popup content table -->  
                             <apex:outputPanel layout="block" styleClass="popup_outputpanel" id="panelid" >
                                 <div class="row">
                                     <div class="col-md-6" style="padding-top:5px">
                                         <h4>Customer Information</h4><br/>
                                         
                                         {!salesOrderDetails.Email__c}<br/>
                                         {!salesOrderDetails.Customer_Name__r.Name}
                                     </div>
                                     <div class="col-md-6" style="padding-top:5px">
                                         <h4>Shipping Method</h4><br/>
                                         Shipping Cost - Free
                                     </div>
                                 </div>
                                 <hr/>
                                 <div class="row">
                                     <div class="col-md-6">
                                         <h4>Billing Address</h4><br/>
                                         {!salesOrderDetails.Bill_To__c}{!if(salesOrderDetails.Bill_To__c!=null,', ','')} <br/>
                                         {!salesOrderDetails.Billing_Street__c}{!if(salesOrderDetails.Billing_Street__c!=null,', ','')}
                                         {!salesOrderDetails.Billing_City__c}{!if(salesOrderDetails.Billing_City__c!=null,', ','')}<br/>
                                         {!salesOrderDetails.Billing_State__c}&nbsp;
                                         {!salesOrderDetails.Billing_ZipCode__c}
                                     </div> 
                                     <div class="col-md-6">
                                         <h4>Shipping Address</h4> <br/>
                                         {!salesOrderDetails.Ship_to__c}{!if(salesOrderDetails.Ship_to__c!=null,', ','')}<br/>
                                         {!salesOrderDetails.Shipping_Street__c}{!if(salesOrderDetails.Shipping_Street__c!=null,', ','')}
                                         {!salesOrderDetails.Shipping_City__c}{!if(salesOrderDetails.Shipping_City__c!=null,', ','')}<br/>
                                         {!salesOrderDetails.Shipping_State__c}&nbsp;
                                         {!salesOrderDetails.Shipping_ZipCode__c}<br/>
                                         
                                         
                                     </div>
                                 </div> 
                                 
                                 <div class="row">   
                                     <apex:outputPanel rendered="{!if(TransactionDetails.size > 0,true,false)}">
                                         <hr/>
                                         <h4 style="margin-left: 15px;">Payment Information</h4><br/>
                                         <apex:repeat value="{!TransactionDetails}" var="tran" >
                                             <!-- <apex:outputText value="{!tran.Sales_Order__c}" ></apex:outputText>-->
                                             <!-- Payment type renderings -->
                                             <div class="col-md-4">
                                                 <apex:outputPanel rendered="{!IF(tran.Payment_Type__c =='PayPal' || tran.Payment_Type__c =='PayPal Express Checkout',true,false)}" style="float:left;width:100%">
                                                     
                                                     <div style="width:100%;float:left;">
                                                         <div style="width: 60%;float:left;padding: 6px 0px !important;">
                                                             <apex:outputText value="{!tran.Payment_Type__c}"/><br/>
                                                             <b class="card-headings">Amount: </b>$<apex:outputText value="{!tran.Amount__c}" /><br/>
                                                             <b class="card-headings"><apex:outputText value="{!tran.AVS_Response__c}" /></b>
                                                         </div>
                                                     </div>
                                                 </apex:outputPanel>
                                                 
                                                 <apex:outputPanel rendered="{!IF(tran.Payment_Type__c =='Credit Card (Authorize.net)',true,false)}">
                                                     
                                                     <div style="width:100%;float:left;">
                                                         <div style="width: 60%;float:left;padding: 6px 0px;">
                                                             <apex:outputText value="Credit Card"/><br/>
                                                             <apex:outputText value="{!tran.Card_Type__c}"/><br/>
                                                             <b class="card-headings">Card #: </b> <apex:outputText value="{!tran.Card_Number__c}"/><br/>
                                                             <b class="card-headings">Amount: </b>$<apex:outputText value="{!tran.Amount__c}" /><br/>
                                                             <!-- <b class="card-headings">AVS Response: </b> <apex:outputText value="{!tran.AVS_Response__c}" /-->
                                                         </div>
                                                     </div>
                                                 </apex:outputPanel>
                                                 
                                                 <apex:outputPanel rendered="{!IF(tran.Payment_Type__c =='Manual Payment',true,false)}">
                                                     
                                                     <div style="width:100%;float:left;">
                                                         <div style="width: 60%;float:left;padding: 6px 0px;">
                                                             <apex:outputText value="{!tran.Payment_Type__c}"/><br/>
                                                             <b class="card-headings">Amount: </b>$<apex:outputText value="{!tran.Amount__c}" /><br/>
                                                             <b class="card-headings"><apex:outputText value="{!tran.AVS_Response__c}" /></b>
                                                         </div>
                                                     </div>
                                                 </apex:outputPanel>
                                                 
                                                 
                                                 <!-- Payment type renderings --> 
                                             </div>
                                         </apex:repeat>
                                     </apex:outputPanel>
                                 </div>
                                 <br/>
                                 <hr/>
                                 <div class="popup_section_header">
                                     <h3><b class="popup_headings">Sales Order Line Items</b></h3>
                                 </div>
                                 
                               <table class="table table-striped table-hover" style="border: 1px solid #ddd;">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th class="manualorder-table2-content">Image</th> 
                                        <th style="text-align:left;">Name</th>
                                        <th class="manualorder-table2-content">SKU</th> 
                                        <th class="manualorder-table2-content">Quantity</th>
                                        <th class="manualorder-table2-content">Total Price</th>
                                        <th class="manualorder-table2-content">Status</th>
                                    </tr>      
                                </thead>
                                <tbody>
                                    <apex:repeat value="{!SoLineItems}" var="proItem" >
                                        <tr>
                                            <td>&#9648;</td>
                                            <td class="manualorder-table2-content"><img src="{!proItem.Product_Url__c}" width="60px" height="45px" /> </td>
                                            <td style="text-align:left;"><apex:outputText value="{!proItem.Product_Name__c}" /> </td>
                                            <td class="manualorder-table2-content"><apex:outputText value="{!proItem.ProductSKU__c}" /> </td>
                                            <td class="manualorder-table2-content"><apex:outputText value="{!proItem.Quantity__c}" style="width: 50px;text-align: center;"/> </td>
                                            <td style="text-align: right !important;">$<apex:inputText id="totalid" value="{!proItem.Sub_Total__c}" style="display:none;text-align: left !important;" /><apex:outputText value="{!proItem.Sub_Total__c}" style="width: 50px;text-align: center;margin-left:0px;"/> </td>
                                            
                                            <td class="manualorder-table2-content"><apex:outputText value="{!proItem.Customer_Item_Status__c}" rendered="{!!if((proItem.Products__r.recordtype.name == 'Bundled' || proItem.Products__r.recordtype.name == 'Protection Plan'),true,false)}"/></td>
                                        </tr>
                                        <apex:repeat rendered="{!if('Bundled' == proItem.Products__r.recordtype.name,true,false)}" value="{!SoLineItems[proItem]}" var="item">
                                            <tr>
                                                <td class="manualorder-table2-content"></td>
                                                <td class="manualorder-table2-content"><img src="{!item.Product_Url__c}" width="70px" height="45px" /> </td>
                                                <td style="text-align:left;"><apex:outputText value="{!item.Product_Name__c}" /></td>
                                                <td class="manualorder-table2-content"><apex:outputText value="{!item.ProductSKU__c}" /></td>
                                                <td class="manualorder-table2-content"><apex:outputText value="{!item.Quantity__c}" style="width: 50px;text-align: center;"/></td>
                                                <td style="text-align: right !important;">$<apex:outputText value="{!item.Sub_Total__c}"/></td>
                                                <td class="manualorder-table2-content"><apex:outputText value="{!item.Customer_Item_Status__c}"/></td>
                                            </tr>
                                        </apex:repeat> 
                                    </apex:repeat>
                                </tbody>
                            </table>
                             </apex:outputPanel>
                             <!--end of popup content table &#x2714; &#9632; &#9658;-->                             
                            <!-- <div class="man-step2-save-btn" style="width: 100%;margin-bottom: 20px;float: left;padding: 0px 308px;">
                                 <apex:commandButton value="Close" rerender="tstpopup" styleClass="manstep3-savebtn manstep3-popupbtn" style="width: 100px !important;font-size: 16px !important;padding: 5px 0px !important;" oncomplete="close()" >
                                     <apex:param assignTo="{!displayPopup}" value="false" name="displayPopup" />
                                 </apex:commandButton>
                             </div>-->
                              </div>
                         <!--end of popup inner container-->
                     </apex:outputPanel>
                 </apex:outputPanel>
                <!--popup Container -->
                
                <div id="main-wrapper">
                    <!-- responsive table -->
                    <div class="container">
                        <div class="heading-orange-color">My Open Orders</div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="table-responsive">
                                    
                                    <table class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th style="width: 270px;">Magento Order Number</th>
                                                <th>Order Date</th>
                                                <th>Order Status</th>
                                                <th>Order Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <apex:repeat value="{!salesOrdersList}" var="salesOrder">
                                                <tr>
                                                    <td>
                                                        <apex:commandLink value="{!salesOrder.Magento_order_No__c}" action="{!ShowSOLineItems}" reRender="tstpopup" > 
                                                            <apex:param name="SOItemId" assignTo="{!SOID}" value="{!salesOrder.id}" id="SOID"/>
                                                        </apex:commandLink>
                                                    </td>
                                                    <td><apex:outputText value="{0, date, MMMM d','  yyyy}"><apex:param value="{!salesOrder.Order_Date__c}" /> </apex:outputText></td>
                                                    <td> <apex:outputtext value="{!salesOrder.Customer_Order_Status__c}"></apex:outputtext></td>
                                                    <td> $&nbsp;<apex:outputtext value="{!salesOrder.Grand_Total__c}"></apex:outputtext></td>
                                                </tr>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
                                    <apex:pageMessages />
                                </div><!--end of .table-responsive-->
                            </div>
                        </div>
                    </div>
                    <!-- end of responsive table -->
                </div>
            </body>    
        </html>
    </apex:form>
</apex:page>